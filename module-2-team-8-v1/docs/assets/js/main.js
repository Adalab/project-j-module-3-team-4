"use strict";const fr=new FileReader,uploadBtn=document.querySelector(".js__profile-trigger"),fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`}function fakeFileClick(){fileField.click()}uploadBtn.addEventListener("click",fakeFileClick),fileField.addEventListener("change",getImage);const angleDownButton1=document.querySelector(".js-angleDown1");angleDownButton1.section=document.querySelector(".js-design");const angleDownButton2=document.querySelector(".js-angleDown2");angleDownButton2.section=document.querySelector(".js-formData");const angleDownButton3=document.querySelector(".js-angleDown3");angleDownButton3.section=document.querySelector(".js-share");const sectionArr=[angleDownButton1,angleDownButton2,angleDownButton3],createButton=document.querySelector(".create"),shareSection=document.querySelector(".js-createText");function displayOrHideContent(e){e.currentTarget.section.classList.toggle("hidden");for(const t of sectionArr)t.section!==e.currentTarget.section&&(t.section.classList.add("hidden"),t.classList.remove("rot"),t.section===angleDownButton3.section&&shareSection.classList.add("hidden"));e.currentTarget.classList.toggle("rot"),e.currentTarget.section.classList.contains("js-share")&&e.currentTarget.section.classList.contains("hidden")&&shareSection.classList.add("hidden")}function displayOrHideShareSection(){shareSection.classList.toggle("hidden")}angleDownButton1.addEventListener("click",displayOrHideContent),angleDownButton2.addEventListener("click",displayOrHideContent),angleDownButton3.addEventListener("click",displayOrHideContent),createButton.addEventListener("click",displayOrHideShareSection),createButton.addEventListener("click",sendData);const coldPalette=document.querySelector(".cold-palette");coldPalette.colorPalette="cold-",coldPalette.photo="url(./assets/images/esperanza.jpg)";const hotPalette=document.querySelector(".hot-palette");hotPalette.colorPalette="red-",hotPalette.photo="url(https://ep02.epimg.net/elpais/imagenes/2018/12/28/gente/1546003359_734416_1546003608_noticia_fotograma.jpg)";const mixPalette=document.querySelector(".mix-palette");mixPalette.colorPalette="mix-",mixPalette.photo="url(./assets/images/esperanza-mix.png)";const cardObj={name:document.querySelector(".js-name"),job:document.querySelector(".js-job"),border:document.querySelector(".js-border-color"),icons:document.querySelectorAll(".js-socialMedia-icons")},userNameElem=document.querySelector(".js-userName"),userJobElem=document.querySelector(".js-userJob"),userPhoneNumberElem=document.querySelector(".js-phoneNumber"),userEmailElem=document.querySelector(".js-email"),userLinkedinElem=document.querySelector(".js-linkedin"),userGithubElem=document.querySelector(".js-github");let userData={palette:1,name:"",job:"",email:"",phone:0,linkedin:"",github:"",photo:""};const renderedUserName=document.querySelector(".js-userName-result"),renderedUserJob=document.querySelector(".js-userJob-result"),renderedUserPhoneNumber=document.querySelector(".js-phone-result"),renderedUserEmail=document.querySelector(".js-email-result"),renderedUserLinkedin=document.querySelector(".js-linkedin-result"),renderedUserGithub=document.querySelector(".js-github-result"),resetButton=document.querySelector(".js-reset-button"),form=document.querySelector(".js-form"),userCardUrl=document.querySelector(".js-url"),twitterShare=document.querySelector(".twitter-share-button"),profileImageCard=document.querySelector(".js__profile-image"),profilePreviewCard=document.querySelector(".js__profile-preview"),fileInput=document.getElementById("img-selector");function changePalette(e){userData.palette=["cold-","red-","mix-"].indexOf(e.currentTarget.colorPalette)+1,0!==userData.photo.search("data:image")&&(profileImage.style.backgroundImage=""+e.currentTarget.photo),""!==userData.photo&&userData.photo||(userData.photo=""+e.currentTarget.photo),localStorage.setItem("data",JSON.stringify(userData));for(const t in cardObj)if("icons"===t)for(const r in cardObj[t]){if("length"===r)break;cardObj[t][r].classList.remove("cold-icon","red-icon","mix-icon"),cardObj[t][r].classList.add(e.currentTarget.colorPalette+"icon")}else cardObj[t].classList.remove("cold-"+t,"red-"+t,"mix-"+t),cardObj[t].classList.add(`${e.currentTarget.colorPalette}${t}`)}function getInputValues(){userData.name=userNameElem.value,userData.job=userJobElem.value,userData.photo=fr.result?fr.result:"url(./assets/images/esperanza.jpg)",userData.phone=userPhoneNumberElem.value,userData.email=userEmailElem.value,userData.linkedin=userLinkedinElem.value,"@"===userGithubElem.value[0]?userData.github=userGithubElem.value.substring(1):userData.github=userGithubElem.value}function renderUserInfo(e){renderedUserName.innerHTML=e.name,renderedUserJob.innerHTML=e.job,renderedUserPhoneNumber.href="tel:"+e.phone,renderedUserEmail.href="mailto:"+e.email,renderedUserLinkedin.href=e.linkedin,renderedUserGithub.href="https://github.com/"+e.github;for(let e in userData){if(""===userData[e]){createButton.disabled=!0,document.querySelector(".js-createText").classList.add("hidden");break}createButton.disabled=!1}}function updateInputHandler(){getInputValues(),renderUserInfo(userData),""===cardObj.name.innerHTML&&(cardObj.name.innerHTML="Nombre Apellido"),""===cardObj.job.innerHTML&&(cardObj.job.innerHTML="Front-end Developer"),localStorage.setItem("data",JSON.stringify(userData))}function resetForm(){form.reset(),updateInputHandler(),profileImage.style.backgroundImage="url(../images/esperanza.jpg)",profileImage.style.backgroundImage="url(../images/esperanza.jpg)",profilePreview.style.backgroundImage="",coldPalette.click()}function sendData(e){e.preventDefault(),fetch("https://us-central1-awesome-cards-cf6f0.cloudfunctions.net/card/",{method:"POST",body:JSON.stringify(userData),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){showURL(e)})).catch((function(e){console.log(e)}))}function showURL(e){e.success?(userCardUrl.href=e.cardURL,userCardUrl.innerHTML=e.cardURL,twitterShare.href="https://twitter.com/intent/tweet?text=Tu%20tarjeta%20es:%20"+e.cardURL):userCardUrl.innerHTML="ERROR:"+e.error}function setUserDataFromStorage(){if(localStorage.getItem("data")){const e=[coldPalette,hotPalette,mixPalette];userData=JSON.parse(localStorage.getItem("data")),e[userData.palette-1].click(),userNameElem.value=userData.name,userJobElem.value=userData.job,userPhoneNumberElem.value=userData.phone,userEmailElem.value=userData.email,userLinkedinElem.value=userData.linkedin,userGithubElem.value=userData.github,renderUserInfo(userData),profileImageCard.style.backgroundImage=`url(${userData.photo})`,profilePreviewCard.style.backgroundImage=`url(${userData.photo})`}}function rem(e){return e/$defaultFontSize*1}coldPalette.addEventListener("click",changePalette),hotPalette.addEventListener("click",changePalette),mixPalette.addEventListener("click",changePalette),setUserDataFromStorage(),userNameElem.addEventListener("keyup",updateInputHandler),userJobElem.addEventListener("keyup",updateInputHandler),userPhoneNumberElem.addEventListener("keyup",updateInputHandler),userEmailElem.addEventListener("keyup",updateInputHandler),userLinkedinElem.addEventListener("keyup",updateInputHandler),userGithubElem.addEventListener("keyup",updateInputHandler),resetButton.addEventListener("click",resetForm),fr.addEventListener("load",updateInputHandler);